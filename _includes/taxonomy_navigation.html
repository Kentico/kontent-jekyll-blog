{% assign current_page_url = page.url | relative_url %}
{% assign home_page_url = '/' | relative_url %}

<div class="navbar">
    <a href="{{ home_page_url }}"
       {% if current_page_url == home_page_url %} class="current" {% endif %}
    >
        Home
    </a>

    {% for term in site.data.kentico.taxonomies.site.terms %}
        {% assign term_page = site.pages | page_for_taxonomy_term: term %}
        {% assign nav_page_url = term_page.url | relative_url %}

        {% if term.terms.size > 0 %}
            <div class="dropdown">
                {% if term_page %}
                    <form>
                        <button
                            {% if current_page_url == nav_page_url %}
                                class="dropbtn current"
                            {% else %}
                                class="dropbtn"
                            {% endif %}
                            formaction="{{ nav_page_url }}"
                        >
                            {{ term.name}}
                            <i class="fa fa-caret-down"></i>
                        </button>
                    </form>
                {% else %}
                    <button class="dropbtn">
                        {{ term.name}}
                        <i class="fa fa-caret-down"></i>
                    </button>
                {% endif %}

                <div class="dropdown-content">
                    {% for sub_term in term.terms %}
                        {% assign sub_term_page = site.pages | page_for_taxonomy_term: sub_term %}
                        {% assign nav_sub_page_url = sub_term_page.url | relative_url %}

                        <a href="{{ nav_sub_page_url }}"
                           {% if current_page_url == nav_sub_page_url %} class="current" {% endif %}
                        >
                            {{ sub_term.name }}
                        </a>
                    {% endfor %}
                </div>
            </div>
        {% else %}
            {% if term_page %}
            <a href="{{ nav_page_url }}"
               {% if current_page_url == nav_page_url %} class="current" {% endif %}
            >
                {{ term.name }}
            </a>
            {% endif %}
        {% endif %}
    {% endfor %}
</div>